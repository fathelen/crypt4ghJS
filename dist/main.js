(()=>{var t={99:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(117);function o(t,e,n){return void 0===e&&(e=new Uint8Array(2)),void 0===n&&(n=0),e[n+0]=t>>>8,e[n+1]=t>>>0,e}function i(t,e,n){return void 0===e&&(e=new Uint8Array(2)),void 0===n&&(n=0),e[n+0]=t>>>0,e[n+1]=t>>>8,e}function a(t,e){return void 0===e&&(e=0),t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]}function s(t,e){return void 0===e&&(e=0),(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}function c(t,e){return void 0===e&&(e=0),t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]}function l(t,e){return void 0===e&&(e=0),(t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e])>>>0}function h(t,e,n){return void 0===e&&(e=new Uint8Array(4)),void 0===n&&(n=0),e[n+0]=t>>>24,e[n+1]=t>>>16,e[n+2]=t>>>8,e[n+3]=t>>>0,e}function u(t,e,n){return void 0===e&&(e=new Uint8Array(4)),void 0===n&&(n=0),e[n+0]=t>>>0,e[n+1]=t>>>8,e[n+2]=t>>>16,e[n+3]=t>>>24,e}function f(t,e,n){return void 0===e&&(e=new Uint8Array(8)),void 0===n&&(n=0),h(t/4294967296>>>0,e,n),h(t>>>0,e,n+4),e}function y(t,e,n){return void 0===e&&(e=new Uint8Array(8)),void 0===n&&(n=0),u(t>>>0,e,n),u(t/4294967296>>>0,e,n+4),e}e.readInt16BE=function(t,e){return void 0===e&&(e=0),(t[e+0]<<8|t[e+1])<<16>>16},e.readUint16BE=function(t,e){return void 0===e&&(e=0),(t[e+0]<<8|t[e+1])>>>0},e.readInt16LE=function(t,e){return void 0===e&&(e=0),(t[e+1]<<8|t[e])<<16>>16},e.readUint16LE=function(t,e){return void 0===e&&(e=0),(t[e+1]<<8|t[e])>>>0},e.writeUint16BE=o,e.writeInt16BE=o,e.writeUint16LE=i,e.writeInt16LE=i,e.readInt32BE=a,e.readUint32BE=s,e.readInt32LE=c,e.readUint32LE=l,e.writeUint32BE=h,e.writeInt32BE=h,e.writeUint32LE=u,e.writeInt32LE=u,e.readInt64BE=function(t,e){void 0===e&&(e=0);var n=a(t,e),r=a(t,e+4);return 4294967296*n+r-4294967296*(r>>31)},e.readUint64BE=function(t,e){return void 0===e&&(e=0),4294967296*s(t,e)+s(t,e+4)},e.readInt64LE=function(t,e){void 0===e&&(e=0);var n=c(t,e);return 4294967296*c(t,e+4)+n-4294967296*(n>>31)},e.readUint64LE=function(t,e){void 0===e&&(e=0);var n=l(t,e);return 4294967296*l(t,e+4)+n},e.writeUint64BE=f,e.writeInt64BE=f,e.writeUint64LE=y,e.writeInt64LE=y,e.readUintBE=function(t,e,n){if(void 0===n&&(n=0),t%8!=0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(t/8>e.length-n)throw new Error("readUintBE: array is too short for the given bitLength");for(var r=0,o=1,i=t/8+n-1;i>=n;i--)r+=e[i]*o,o*=256;return r},e.readUintLE=function(t,e,n){if(void 0===n&&(n=0),t%8!=0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(t/8>e.length-n)throw new Error("readUintLE: array is too short for the given bitLength");for(var r=0,o=1,i=n;i<n+t/8;i++)r+=e[i]*o,o*=256;return r},e.writeUintBE=function(t,e,n,o){if(void 0===n&&(n=new Uint8Array(t/8)),void 0===o&&(o=0),t%8!=0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!r.isSafeInteger(e))throw new Error("writeUintBE value must be an integer");for(var i=1,a=t/8+o-1;a>=o;a--)n[a]=e/i&255,i*=256;return n},e.writeUintLE=function(t,e,n,o){if(void 0===n&&(n=new Uint8Array(t/8)),void 0===o&&(o=0),t%8!=0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!r.isSafeInteger(e))throw new Error("writeUintLE value must be an integer");for(var i=1,a=o;a<o+t/8;a++)n[a]=e/i&255,i*=256;return n},e.readFloat32BE=function(t,e){return void 0===e&&(e=0),new DataView(t.buffer,t.byteOffset,t.byteLength).getFloat32(e)},e.readFloat32LE=function(t,e){return void 0===e&&(e=0),new DataView(t.buffer,t.byteOffset,t.byteLength).getFloat32(e,!0)},e.readFloat64BE=function(t,e){return void 0===e&&(e=0),new DataView(t.buffer,t.byteOffset,t.byteLength).getFloat64(e)},e.readFloat64LE=function(t,e){return void 0===e&&(e=0),new DataView(t.buffer,t.byteOffset,t.byteLength).getFloat64(e,!0)},e.writeFloat32BE=function(t,e,n){return void 0===e&&(e=new Uint8Array(4)),void 0===n&&(n=0),new DataView(e.buffer,e.byteOffset,e.byteLength).setFloat32(n,t),e},e.writeFloat32LE=function(t,e,n){return void 0===e&&(e=new Uint8Array(4)),void 0===n&&(n=0),new DataView(e.buffer,e.byteOffset,e.byteLength).setFloat32(n,t,!0),e},e.writeFloat64BE=function(t,e,n){return void 0===e&&(e=new Uint8Array(8)),void 0===n&&(n=0),new DataView(e.buffer,e.byteOffset,e.byteLength).setFloat64(n,t),e},e.writeFloat64LE=function(t,e,n){return void 0===e&&(e=new Uint8Array(8)),void 0===n&&(n=0),new DataView(e.buffer,e.byteOffset,e.byteLength).setFloat64(n,t,!0),e}},322:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(99),o=n(309);e.BLOCK_SIZE=128,e.DIGEST_LENGTH=64,e.KEY_LENGTH=64,e.PERSONALIZATION_LENGTH=16,e.SALT_LENGTH=16,e.MAX_LEAF_SIZE=Math.pow(2,32)-1,e.MAX_FANOUT=255,e.MAX_MAX_DEPTH=255;var i=new Uint32Array([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),a=[[0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30],[28,20,8,16,18,30,26,12,2,24,0,4,22,14,10,6],[22,16,24,0,10,4,30,26,20,28,6,12,14,2,18,8],[14,18,6,2,26,24,22,28,4,12,10,20,8,0,30,16],[18,0,10,14,4,8,20,30,28,2,22,24,12,16,6,26],[4,24,12,20,0,22,16,6,8,26,14,10,30,28,2,18],[24,10,2,30,28,26,8,20,0,14,12,6,18,4,16,22],[26,22,14,28,24,2,6,18,10,0,30,8,16,12,4,20],[12,30,28,18,22,6,0,16,24,4,26,14,2,8,20,10],[20,4,16,8,14,12,2,10,30,22,18,28,6,24,26,0],[0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30],[28,20,8,16,18,30,26,12,2,24,0,4,22,14,10,6]],s=function(){function t(t,n){if(void 0===t&&(t=64),this.digestLength=t,this.blockSize=e.BLOCK_SIZE,this._state=new Int32Array(i),this._buffer=new Uint8Array(e.BLOCK_SIZE),this._bufferLength=0,this._ctr=new Uint32Array(4),this._flag=new Uint32Array(4),this._lastNode=!1,this._finished=!1,this._vtmp=new Uint32Array(32),this._mtmp=new Uint32Array(32),t<1||t>e.DIGEST_LENGTH)throw new Error("blake2b: wrong digest length");n&&this.validateConfig(n);var o=0;n&&n.key&&(o=n.key.length);var a=1,s=1;n&&n.tree&&(a=n.tree.fanout,s=n.tree.maxDepth),this._state[0]^=t|o<<8|a<<16|s<<24,n&&n.tree&&(this._state[1]^=n.tree.leafSize,this._state[2]^=n.tree.nodeOffsetLowBits,this._state[3]^=n.tree.nodeOffsetHighBits,this._state[4]^=n.tree.nodeDepth|n.tree.innerDigestLength<<8,this._lastNode=n.tree.lastNode),n&&n.salt&&(this._state[8]^=r.readUint32LE(n.salt,0),this._state[9]^=r.readUint32LE(n.salt,4),this._state[10]^=r.readUint32LE(n.salt,8),this._state[11]^=r.readUint32LE(n.salt,12)),n&&n.personalization&&(this._state[12]^=r.readUint32LE(n.personalization,0),this._state[13]^=r.readUint32LE(n.personalization,4),this._state[14]^=r.readUint32LE(n.personalization,8),this._state[15]^=r.readUint32LE(n.personalization,12)),this._initialState=new Uint32Array(this._state),n&&n.key&&o>0&&(this._paddedKey=new Uint8Array(e.BLOCK_SIZE),this._paddedKey.set(n.key),this._buffer.set(this._paddedKey),this._bufferLength=e.BLOCK_SIZE)}return t.prototype.reset=function(){return this._state.set(this._initialState),this._paddedKey?(this._buffer.set(this._paddedKey),this._bufferLength=e.BLOCK_SIZE):this._bufferLength=0,o.wipe(this._ctr),o.wipe(this._flag),this._finished=!1,this},t.prototype.validateConfig=function(t){if(t.key&&t.key.length>e.KEY_LENGTH)throw new Error("blake2b: wrong key length");if(t.salt&&t.salt.length!==e.SALT_LENGTH)throw new Error("blake2b: wrong salt length");if(t.personalization&&t.personalization.length!==e.PERSONALIZATION_LENGTH)throw new Error("blake2b: wrong personalization length");if(t.tree){if(t.tree.fanout<0||t.tree.fanout>e.MAX_FANOUT)throw new Error("blake2b: wrong tree fanout");if(t.tree.maxDepth<0||t.tree.maxDepth>e.MAX_MAX_DEPTH)throw new Error("blake2b: wrong tree depth");if(t.tree.leafSize<0||t.tree.leafSize>e.MAX_LEAF_SIZE)throw new Error("blake2b: wrong leaf size");if(t.tree.innerDigestLength<0||t.tree.innerDigestLength>e.DIGEST_LENGTH)throw new Error("blake2b: wrong tree inner digest length")}},t.prototype.update=function(t,n){if(void 0===n&&(n=t.length),this._finished)throw new Error("blake2b: can't update because hash was finished.");var r=e.BLOCK_SIZE-this._bufferLength,o=0;if(0===n)return this;if(n>r){for(var i=0;i<r;i++)this._buffer[this._bufferLength+i]=t[o+i];this._processBlock(e.BLOCK_SIZE),o+=r,n-=r,this._bufferLength=0}for(;n>e.BLOCK_SIZE;){for(i=0;i<e.BLOCK_SIZE;i++)this._buffer[i]=t[o+i];this._processBlock(e.BLOCK_SIZE),o+=e.BLOCK_SIZE,n-=e.BLOCK_SIZE,this._bufferLength=0}for(i=0;i<n;i++)this._buffer[this._bufferLength+i]=t[o+i];return this._bufferLength+=n,this},t.prototype.finish=function(t){if(!this._finished){for(var n=this._bufferLength;n<e.BLOCK_SIZE;n++)this._buffer[n]=0;this._flag[0]=4294967295,this._flag[1]=4294967295,this._lastNode&&(this._flag[2]=4294967295,this._flag[3]=4294967295),this._processBlock(this._bufferLength),this._finished=!0}var o=this._buffer.subarray(0,64);for(n=0;n<16;n++)r.writeUint32LE(this._state[n],o,4*n);return t.set(o.subarray(0,t.length)),this},t.prototype.digest=function(){var t=new Uint8Array(this.digestLength);return this.finish(t),t},t.prototype.clean=function(){o.wipe(this._vtmp),o.wipe(this._mtmp),o.wipe(this._state),o.wipe(this._buffer),o.wipe(this._initialState),this._paddedKey&&o.wipe(this._paddedKey),this._bufferLength=0,o.wipe(this._ctr),o.wipe(this._flag),this._lastNode=!1,this._finished=!1},t.prototype.saveState=function(){if(this._finished)throw new Error("blake2b: cannot save finished state");return{state:new Uint32Array(this._state),buffer:new Uint8Array(this._buffer),bufferLength:this._bufferLength,ctr:new Uint32Array(this._ctr),flag:new Uint32Array(this._flag),lastNode:this._lastNode,paddedKey:this._paddedKey?new Uint8Array(this._paddedKey):void 0,initialState:new Uint32Array(this._initialState)}},t.prototype.restoreState=function(t){return this._state.set(t.state),this._buffer.set(t.buffer),this._bufferLength=t.bufferLength,this._ctr.set(t.ctr),this._flag.set(t.flag),this._lastNode=t.lastNode,this._paddedKey&&o.wipe(this._paddedKey),this._paddedKey=t.paddedKey?new Uint8Array(t.paddedKey):void 0,this._initialState.set(t.initialState),this},t.prototype.cleanSavedState=function(t){o.wipe(t.state),o.wipe(t.buffer),o.wipe(t.initialState),t.paddedKey&&o.wipe(t.paddedKey),t.bufferLength=0,o.wipe(t.ctr),o.wipe(t.flag),t.lastNode=!1},t.prototype._G=function(t,e,n,r,o,i,a,s,c,l,h,u,f){var y=t[e],g=t[i],d=t[n],p=t[a],w=t[r],b=t[s],_=t[o],E=t[c],A=65535&y,m=y>>>16,v=65535&g,U=g>>>16;m+=d>>>16,v+=65535&p,U+=p>>>16,v+=(m+=(A+=65535&d)>>>16)>>>16,A=65535&(y=65535&A|m<<16),m=y>>>16,v=65535&(g=65535&v|(U+=v>>>16)<<16),U=g>>>16,m+=l>>>16,v+=65535&h,U+=h>>>16,y=65535&(A+=65535&l)|(m+=A>>>16)<<16,A=E^=g=65535&(v+=m>>>16)|(U+=v>>>16)<<16,E=_^=y,_=A,A=65535&w,m=w>>>16,v=65535&b,U=b>>>16,m+=_>>>16,v+=65535&E,U+=E>>>16,A=(d^=w=65535&(A+=65535&_)|(m+=A>>>16)<<16)<<8|(p^=b=65535&(v+=m>>>16)|(U+=v>>>16)<<16)>>>24,d=p<<8|d>>>24,p=A,A=65535&y,m=y>>>16,v=65535&g,U=g>>>16,m+=d>>>16,v+=65535&p,U+=p>>>16,v+=(m+=(A+=65535&d)>>>16)>>>16,A=65535&(y=65535&A|m<<16),m=y>>>16,v=65535&(g=65535&v|(U+=v>>>16)<<16),U=g>>>16,m+=u>>>16,v+=65535&f,U+=f>>>16,A=(_^=y=65535&(A+=65535&u)|(m+=A>>>16)<<16)<<16|(E^=g=65535&(v+=m>>>16)|(U+=v>>>16)<<16)>>>16,_=E<<16|_>>>16,E=A,A=65535&w,m=w>>>16,v=65535&b,U=b>>>16,m+=_>>>16,v+=65535&E,U+=E>>>16,A=(p^=b=65535&(v+=(m+=(A+=65535&_)>>>16)>>>16)|(U+=v>>>16)<<16)<<1|(d^=w=65535&A|m<<16)>>>31,d=d<<1|p>>>31,p=A,t[e]=y,t[i]=g,t[n]=d,t[a]=p,t[r]=w,t[s]=b,t[o]=_,t[c]=E},t.prototype._incrementCounter=function(t){for(var e=0;e<3;e++){var n=this._ctr[e]+t;if(this._ctr[e]=n>>>0,this._ctr[e]===n)return;t=1}},t.prototype._processBlock=function(t){this._incrementCounter(t);var e=this._vtmp;e.set(this._state),e.set(i,16),e[24]^=this._ctr[0],e[25]^=this._ctr[1],e[26]^=this._ctr[2],e[27]^=this._ctr[3],e[28]^=this._flag[0],e[29]^=this._flag[1],e[30]^=this._flag[2],e[31]^=this._flag[3];for(var n=this._mtmp,o=0;o<32;o++)n[o]=r.readUint32LE(this._buffer,4*o);for(var s=0;s<12;s++)this._G(e,0,8,16,24,1,9,17,25,n[a[s][0]],n[a[s][0]+1],n[a[s][1]],n[a[s][1]+1]),this._G(e,2,10,18,26,3,11,19,27,n[a[s][2]],n[a[s][2]+1],n[a[s][3]],n[a[s][3]+1]),this._G(e,4,12,20,28,5,13,21,29,n[a[s][4]],n[a[s][4]+1],n[a[s][5]],n[a[s][5]+1]),this._G(e,6,14,22,30,7,15,23,31,n[a[s][6]],n[a[s][6]+1],n[a[s][7]],n[a[s][7]+1]),this._G(e,0,10,20,30,1,11,21,31,n[a[s][8]],n[a[s][8]+1],n[a[s][9]],n[a[s][9]+1]),this._G(e,2,12,22,24,3,13,23,25,n[a[s][10]],n[a[s][10]+1],n[a[s][11]],n[a[s][11]+1]),this._G(e,4,14,16,26,5,15,17,27,n[a[s][12]],n[a[s][12]+1],n[a[s][13]],n[a[s][13]+1]),this._G(e,6,8,18,28,7,9,19,29,n[a[s][14]],n[a[s][14]+1],n[a[s][15]],n[a[s][15]+1]);for(o=0;o<16;o++)this._state[o]^=e[o]^e[o+16]},t}();e.BLAKE2b=s,e.hash=function(t,n,r){void 0===n&&(n=e.DIGEST_LENGTH);var o=new s(n,r);o.update(t);var i=o.digest();return o.clean(),i}},117:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.mul=Math.imul||function(t,e){var n=65535&t,r=65535&e;return n*r+((t>>>16&65535)*r+n*(e>>>16&65535)<<16>>>0)|0},e.add=function(t,e){return t+e|0},e.sub=function(t,e){return t-e|0},e.rotl=function(t,e){return t<<e|t>>>32-e},e.rotr=function(t,e){return t<<32-e|t>>>e},e.isInteger=Number.isInteger||function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t},e.MAX_SAFE_INTEGER=9007199254740991,e.isSafeInteger=function(t){return e.isInteger(t)&&t>=-e.MAX_SAFE_INTEGER&&t<=e.MAX_SAFE_INTEGER}},416:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.randomStringForEntropy=e.randomString=e.randomUint32=e.randomBytes=e.defaultRandomSource=void 0;const r=n(8),o=n(99),i=n(309);function a(t,n=e.defaultRandomSource){return n.randomBytes(t)}e.defaultRandomSource=new r.SystemRandomSource,e.randomBytes=a,e.randomUint32=function(t=e.defaultRandomSource){const n=a(4,t),r=(0,o.readUint32LE)(n);return(0,i.wipe)(n),r};const s="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function c(t,n=s,r=e.defaultRandomSource){if(n.length<2)throw new Error("randomString charset is too short");if(n.length>256)throw new Error("randomString charset is too long");let o="";const c=n.length,l=256-256%c;for(;t>0;){const e=a(Math.ceil(256*t/l),r);for(let r=0;r<e.length&&t>0;r++){const i=e[r];i<l&&(o+=n.charAt(i%c),t--)}(0,i.wipe)(e)}return o}e.randomString=c,e.randomStringForEntropy=function(t,n=s,r=e.defaultRandomSource){return c(Math.ceil(t/(Math.log(n.length)/Math.LN2)),n,r)}},455:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BrowserRandomSource=void 0,e.BrowserRandomSource=class{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const t="undefined"!=typeof self?self.crypto||self.msCrypto:null;t&&void 0!==t.getRandomValues&&(this._crypto=t,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(t){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const e=new Uint8Array(t);for(let t=0;t<e.length;t+=65536)this._crypto.getRandomValues(e.subarray(t,t+Math.min(e.length-t,65536)));return e}}},871:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.NodeRandomSource=void 0;const r=n(309);e.NodeRandomSource=class{constructor(){this.isAvailable=!1,this.isInstantiated=!1;{const t=n(883);t&&t.randomBytes&&(this._crypto=t,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(t){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let e=this._crypto.randomBytes(t);if(e.length!==t)throw new Error("NodeRandomSource: got fewer bytes than requested");const n=new Uint8Array(t);for(let t=0;t<n.length;t++)n[t]=e[t];return(0,r.wipe)(e),n}}},8:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SystemRandomSource=void 0;const r=n(455),o=n(871);e.SystemRandomSource=class{constructor(){return this.isAvailable=!1,this.name="",this._source=new r.BrowserRandomSource,this._source.isAvailable?(this.isAvailable=!0,void(this.name="Browser")):(this._source=new o.NodeRandomSource,this._source.isAvailable?(this.isAvailable=!0,void(this.name="Node")):void 0)}randomBytes(t){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(t)}}},309:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.wipe=function(t){for(var e=0;e<t.length;e++)t[e]=0;return t}},664:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.sharedKey=e.generateKeyPair=e.generateKeyPairFromSeed=e.scalarMultBase=e.scalarMult=e.SHARED_KEY_LENGTH=e.SECRET_KEY_LENGTH=e.PUBLIC_KEY_LENGTH=void 0;const r=n(416),o=n(309);function i(t){const e=new Float64Array(16);if(t)for(let n=0;n<t.length;n++)e[n]=t[n];return e}e.PUBLIC_KEY_LENGTH=32,e.SECRET_KEY_LENGTH=32,e.SHARED_KEY_LENGTH=32;const a=new Uint8Array(32);a[0]=9;const s=i([56129,1]);function c(t){let e=1;for(let n=0;n<16;n++){let r=t[n]+e+65535;e=Math.floor(r/65536),t[n]=r-65536*e}t[0]+=e-1+37*(e-1)}function l(t,e,n){const r=~(n-1);for(let n=0;n<16;n++){const o=r&(t[n]^e[n]);t[n]^=o,e[n]^=o}}function h(t,e,n){for(let r=0;r<16;r++)t[r]=e[r]+n[r]}function u(t,e,n){for(let r=0;r<16;r++)t[r]=e[r]-n[r]}function f(t,e,n){let r,o,i=0,a=0,s=0,c=0,l=0,h=0,u=0,f=0,y=0,g=0,d=0,p=0,w=0,b=0,_=0,E=0,A=0,m=0,v=0,U=0,L=0,B=0,I=0,S=0,K=0,k=0,N=0,T=0,M=0,C=0,P=0,G=n[0],R=n[1],H=n[2],O=n[3],D=n[4],F=n[5],Y=n[6],x=n[7],z=n[8],Z=n[9],V=n[10],j=n[11],X=n[12],q=n[13],W=n[14],J=n[15];r=e[0],i+=r*G,a+=r*R,s+=r*H,c+=r*O,l+=r*D,h+=r*F,u+=r*Y,f+=r*x,y+=r*z,g+=r*Z,d+=r*V,p+=r*j,w+=r*X,b+=r*q,_+=r*W,E+=r*J,r=e[1],a+=r*G,s+=r*R,c+=r*H,l+=r*O,h+=r*D,u+=r*F,f+=r*Y,y+=r*x,g+=r*z,d+=r*Z,p+=r*V,w+=r*j,b+=r*X,_+=r*q,E+=r*W,A+=r*J,r=e[2],s+=r*G,c+=r*R,l+=r*H,h+=r*O,u+=r*D,f+=r*F,y+=r*Y,g+=r*x,d+=r*z,p+=r*Z,w+=r*V,b+=r*j,_+=r*X,E+=r*q,A+=r*W,m+=r*J,r=e[3],c+=r*G,l+=r*R,h+=r*H,u+=r*O,f+=r*D,y+=r*F,g+=r*Y,d+=r*x,p+=r*z,w+=r*Z,b+=r*V,_+=r*j,E+=r*X,A+=r*q,m+=r*W,v+=r*J,r=e[4],l+=r*G,h+=r*R,u+=r*H,f+=r*O,y+=r*D,g+=r*F,d+=r*Y,p+=r*x,w+=r*z,b+=r*Z,_+=r*V,E+=r*j,A+=r*X,m+=r*q,v+=r*W,U+=r*J,r=e[5],h+=r*G,u+=r*R,f+=r*H,y+=r*O,g+=r*D,d+=r*F,p+=r*Y,w+=r*x,b+=r*z,_+=r*Z,E+=r*V,A+=r*j,m+=r*X,v+=r*q,U+=r*W,L+=r*J,r=e[6],u+=r*G,f+=r*R,y+=r*H,g+=r*O,d+=r*D,p+=r*F,w+=r*Y,b+=r*x,_+=r*z,E+=r*Z,A+=r*V,m+=r*j,v+=r*X,U+=r*q,L+=r*W,B+=r*J,r=e[7],f+=r*G,y+=r*R,g+=r*H,d+=r*O,p+=r*D,w+=r*F,b+=r*Y,_+=r*x,E+=r*z,A+=r*Z,m+=r*V,v+=r*j,U+=r*X,L+=r*q,B+=r*W,I+=r*J,r=e[8],y+=r*G,g+=r*R,d+=r*H,p+=r*O,w+=r*D,b+=r*F,_+=r*Y,E+=r*x,A+=r*z,m+=r*Z,v+=r*V,U+=r*j,L+=r*X,B+=r*q,I+=r*W,S+=r*J,r=e[9],g+=r*G,d+=r*R,p+=r*H,w+=r*O,b+=r*D,_+=r*F,E+=r*Y,A+=r*x,m+=r*z,v+=r*Z,U+=r*V,L+=r*j,B+=r*X,I+=r*q,S+=r*W,K+=r*J,r=e[10],d+=r*G,p+=r*R,w+=r*H,b+=r*O,_+=r*D,E+=r*F,A+=r*Y,m+=r*x,v+=r*z,U+=r*Z,L+=r*V,B+=r*j,I+=r*X,S+=r*q,K+=r*W,k+=r*J,r=e[11],p+=r*G,w+=r*R,b+=r*H,_+=r*O,E+=r*D,A+=r*F,m+=r*Y,v+=r*x,U+=r*z,L+=r*Z,B+=r*V,I+=r*j,S+=r*X,K+=r*q,k+=r*W,N+=r*J,r=e[12],w+=r*G,b+=r*R,_+=r*H,E+=r*O,A+=r*D,m+=r*F,v+=r*Y,U+=r*x,L+=r*z,B+=r*Z,I+=r*V,S+=r*j,K+=r*X,k+=r*q,N+=r*W,T+=r*J,r=e[13],b+=r*G,_+=r*R,E+=r*H,A+=r*O,m+=r*D,v+=r*F,U+=r*Y,L+=r*x,B+=r*z,I+=r*Z,S+=r*V,K+=r*j,k+=r*X,N+=r*q,T+=r*W,M+=r*J,r=e[14],_+=r*G,E+=r*R,A+=r*H,m+=r*O,v+=r*D,U+=r*F,L+=r*Y,B+=r*x,I+=r*z,S+=r*Z,K+=r*V,k+=r*j,N+=r*X,T+=r*q,M+=r*W,C+=r*J,r=e[15],E+=r*G,A+=r*R,m+=r*H,v+=r*O,U+=r*D,L+=r*F,B+=r*Y,I+=r*x,S+=r*z,K+=r*Z,k+=r*V,N+=r*j,T+=r*X,M+=r*q,C+=r*W,P+=r*J,i+=38*A,a+=38*m,s+=38*v,c+=38*U,l+=38*L,h+=38*B,u+=38*I,f+=38*S,y+=38*K,g+=38*k,d+=38*N,p+=38*T,w+=38*M,b+=38*C,_+=38*P,o=1,r=i+o+65535,o=Math.floor(r/65536),i=r-65536*o,r=a+o+65535,o=Math.floor(r/65536),a=r-65536*o,r=s+o+65535,o=Math.floor(r/65536),s=r-65536*o,r=c+o+65535,o=Math.floor(r/65536),c=r-65536*o,r=l+o+65535,o=Math.floor(r/65536),l=r-65536*o,r=h+o+65535,o=Math.floor(r/65536),h=r-65536*o,r=u+o+65535,o=Math.floor(r/65536),u=r-65536*o,r=f+o+65535,o=Math.floor(r/65536),f=r-65536*o,r=y+o+65535,o=Math.floor(r/65536),y=r-65536*o,r=g+o+65535,o=Math.floor(r/65536),g=r-65536*o,r=d+o+65535,o=Math.floor(r/65536),d=r-65536*o,r=p+o+65535,o=Math.floor(r/65536),p=r-65536*o,r=w+o+65535,o=Math.floor(r/65536),w=r-65536*o,r=b+o+65535,o=Math.floor(r/65536),b=r-65536*o,r=_+o+65535,o=Math.floor(r/65536),_=r-65536*o,r=E+o+65535,o=Math.floor(r/65536),E=r-65536*o,i+=o-1+37*(o-1),o=1,r=i+o+65535,o=Math.floor(r/65536),i=r-65536*o,r=a+o+65535,o=Math.floor(r/65536),a=r-65536*o,r=s+o+65535,o=Math.floor(r/65536),s=r-65536*o,r=c+o+65535,o=Math.floor(r/65536),c=r-65536*o,r=l+o+65535,o=Math.floor(r/65536),l=r-65536*o,r=h+o+65535,o=Math.floor(r/65536),h=r-65536*o,r=u+o+65535,o=Math.floor(r/65536),u=r-65536*o,r=f+o+65535,o=Math.floor(r/65536),f=r-65536*o,r=y+o+65535,o=Math.floor(r/65536),y=r-65536*o,r=g+o+65535,o=Math.floor(r/65536),g=r-65536*o,r=d+o+65535,o=Math.floor(r/65536),d=r-65536*o,r=p+o+65535,o=Math.floor(r/65536),p=r-65536*o,r=w+o+65535,o=Math.floor(r/65536),w=r-65536*o,r=b+o+65535,o=Math.floor(r/65536),b=r-65536*o,r=_+o+65535,o=Math.floor(r/65536),_=r-65536*o,r=E+o+65535,o=Math.floor(r/65536),E=r-65536*o,i+=o-1+37*(o-1),t[0]=i,t[1]=a,t[2]=s,t[3]=c,t[4]=l,t[5]=h,t[6]=u,t[7]=f,t[8]=y,t[9]=g,t[10]=d,t[11]=p,t[12]=w,t[13]=b,t[14]=_,t[15]=E}function y(t,e){f(t,e,e)}function g(t,e){const n=new Uint8Array(32),r=new Float64Array(80),o=i(),a=i(),g=i(),d=i(),p=i(),w=i();for(let e=0;e<31;e++)n[e]=t[e];n[31]=127&t[31]|64,n[0]&=248,function(t,e){for(let n=0;n<16;n++)t[n]=e[2*n]+(e[2*n+1]<<8);t[15]&=32767}(r,e);for(let t=0;t<16;t++)a[t]=r[t];o[0]=d[0]=1;for(let t=254;t>=0;--t){const e=n[t>>>3]>>>(7&t)&1;l(o,a,e),l(g,d,e),h(p,o,g),u(o,o,g),h(g,a,d),u(a,a,d),y(d,p),y(w,o),f(o,g,o),f(g,a,p),h(p,o,g),u(o,o,g),y(a,o),u(g,d,w),f(o,g,s),h(o,o,d),f(g,g,o),f(o,d,w),f(d,a,r),y(a,p),l(o,a,e),l(g,d,e)}for(let t=0;t<16;t++)r[t+16]=o[t],r[t+32]=g[t],r[t+48]=a[t],r[t+64]=d[t];const b=r.subarray(32),_=r.subarray(16);!function(t,e){const n=i();for(let t=0;t<16;t++)n[t]=e[t];for(let t=253;t>=0;t--)y(n,n),2!==t&&4!==t&&f(n,n,e);for(let e=0;e<16;e++)t[e]=n[e]}(b,b),f(_,_,b);const E=new Uint8Array(32);return function(t,e){const n=i(),r=i();for(let t=0;t<16;t++)r[t]=e[t];c(r),c(r),c(r);for(let t=0;t<2;t++){n[0]=r[0]-65517;for(let t=1;t<15;t++)n[t]=r[t]-65535-(n[t-1]>>16&1),n[t-1]&=65535;n[15]=r[15]-32767-(n[14]>>16&1);const t=n[15]>>16&1;n[14]&=65535,l(r,n,1-t)}for(let e=0;e<16;e++)t[2*e]=255&r[e],t[2*e+1]=r[e]>>8}(E,_),E}function d(t){return g(t,a)}function p(t){if(t.length!==e.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${e.SECRET_KEY_LENGTH} bytes`);const n=new Uint8Array(t);return{publicKey:d(n),secretKey:n}}e.scalarMult=g,e.scalarMultBase=d,e.generateKeyPairFromSeed=p,e.generateKeyPair=function(t){const e=(0,r.randomBytes)(32,t),n=p(e);return(0,o.wipe)(e),n},e.sharedKey=function(t,n,r=!1){if(t.length!==e.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(n.length!==e.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const o=g(t,n);if(r){let t=0;for(let e=0;e<o.length;e++)t|=o[e];if(0===t)throw new Error("X25519: invalid shared key")}return o}},635:function(t){"use strict";!function(e){const n=2147483647;function r(t){const e=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);let n=1779033703,r=3144134277,o=1013904242,i=2773480762,a=1359893119,s=2600822924,c=528734635,l=1541459225;const h=new Uint32Array(64);function u(t){let u=0,f=t.length;for(;f>=64;){let y,g,d,p,w,b=n,_=r,E=o,A=i,m=a,v=s,U=c,L=l;for(g=0;g<16;g++)d=u+4*g,h[g]=(255&t[d])<<24|(255&t[d+1])<<16|(255&t[d+2])<<8|255&t[d+3];for(g=16;g<64;g++)y=h[g-2],p=(y>>>17|y<<15)^(y>>>19|y<<13)^y>>>10,y=h[g-15],w=(y>>>7|y<<25)^(y>>>18|y<<14)^y>>>3,h[g]=(p+h[g-7]|0)+(w+h[g-16]|0)|0;for(g=0;g<64;g++)p=(((m>>>6|m<<26)^(m>>>11|m<<21)^(m>>>25|m<<7))+(m&v^~m&U)|0)+(L+(e[g]+h[g]|0)|0)|0,w=((b>>>2|b<<30)^(b>>>13|b<<19)^(b>>>22|b<<10))+(b&_^b&E^_&E)|0,L=U,U=v,v=m,m=A+p|0,A=E,E=_,_=b,b=p+w|0;n=n+b|0,r=r+_|0,o=o+E|0,i=i+A|0,a=a+m|0,s=s+v|0,c=c+U|0,l=l+L|0,u+=64,f-=64}}u(t);let f,y=t.length%64,g=t.length/536870912|0,d=t.length<<3,p=y<56?56:120,w=t.slice(t.length-y,t.length);for(w.push(128),f=y+1;f<p;f++)w.push(0);return w.push(g>>>24&255),w.push(g>>>16&255),w.push(g>>>8&255),w.push(g>>>0&255),w.push(d>>>24&255),w.push(d>>>16&255),w.push(d>>>8&255),w.push(d>>>0&255),u(w),[n>>>24&255,n>>>16&255,n>>>8&255,n>>>0&255,r>>>24&255,r>>>16&255,r>>>8&255,r>>>0&255,o>>>24&255,o>>>16&255,o>>>8&255,o>>>0&255,i>>>24&255,i>>>16&255,i>>>8&255,i>>>0&255,a>>>24&255,a>>>16&255,a>>>8&255,a>>>0&255,s>>>24&255,s>>>16&255,s>>>8&255,s>>>0&255,c>>>24&255,c>>>16&255,c>>>8&255,c>>>0&255,l>>>24&255,l>>>16&255,l>>>8&255,l>>>0&255]}function o(t,e,n){t=t.length<=64?t:r(t);const o=64+e.length+4,i=new Array(o),a=new Array(64);let s,c=[];for(s=0;s<64;s++)i[s]=54;for(s=0;s<t.length;s++)i[s]^=t[s];for(s=0;s<e.length;s++)i[64+s]=e[s];for(s=o-4;s<o;s++)i[s]=0;for(s=0;s<64;s++)a[s]=92;for(s=0;s<t.length;s++)a[s]^=t[s];function l(){for(let t=o-1;t>=o-4;t--){if(i[t]++,i[t]<=255)return;i[t]=0}}for(;n>=32;)l(),c=c.concat(r(a.concat(r(i)))),n-=32;return n>0&&(l(),c=c.concat(r(a.concat(r(i))).slice(0,n))),c}function i(t,e,n,r,o){let i;for(l(t,16*(2*n-1),o,0,16),i=0;i<2*n;i++)c(t,16*i,o,16),s(o,r),l(o,0,t,e+16*i,16);for(i=0;i<n;i++)l(t,e+2*i*16,t,16*i,16);for(i=0;i<n;i++)l(t,e+16*(2*i+1),t,16*(i+n),16)}function a(t,e){return t<<e|t>>>32-e}function s(t,e){l(t,0,e,0,16);for(let t=8;t>0;t-=2)e[4]^=a(e[0]+e[12],7),e[8]^=a(e[4]+e[0],9),e[12]^=a(e[8]+e[4],13),e[0]^=a(e[12]+e[8],18),e[9]^=a(e[5]+e[1],7),e[13]^=a(e[9]+e[5],9),e[1]^=a(e[13]+e[9],13),e[5]^=a(e[1]+e[13],18),e[14]^=a(e[10]+e[6],7),e[2]^=a(e[14]+e[10],9),e[6]^=a(e[2]+e[14],13),e[10]^=a(e[6]+e[2],18),e[3]^=a(e[15]+e[11],7),e[7]^=a(e[3]+e[15],9),e[11]^=a(e[7]+e[3],13),e[15]^=a(e[11]+e[7],18),e[1]^=a(e[0]+e[3],7),e[2]^=a(e[1]+e[0],9),e[3]^=a(e[2]+e[1],13),e[0]^=a(e[3]+e[2],18),e[6]^=a(e[5]+e[4],7),e[7]^=a(e[6]+e[5],9),e[4]^=a(e[7]+e[6],13),e[5]^=a(e[4]+e[7],18),e[11]^=a(e[10]+e[9],7),e[8]^=a(e[11]+e[10],9),e[9]^=a(e[8]+e[11],13),e[10]^=a(e[9]+e[8],18),e[12]^=a(e[15]+e[14],7),e[13]^=a(e[12]+e[15],9),e[14]^=a(e[13]+e[12],13),e[15]^=a(e[14]+e[13],18);for(let n=0;n<16;++n)t[n]+=e[n]}function c(t,e,n,r){for(let o=0;o<r;o++)n[o]^=t[e+o]}function l(t,e,n,r,o){for(;o--;)n[r++]=t[e++]}function h(t){if(!t||"number"!=typeof t.length)return!1;for(let e=0;e<t.length;e++){const n=t[e];if("number"!=typeof n||n%1||n<0||n>=256)return!1}return!0}function u(t,e){if("number"!=typeof t||t%1)throw new Error("invalid "+e);return t}function f(t,e,r,a,s,f,y){if(r=u(r,"N"),a=u(a,"r"),s=u(s,"p"),f=u(f,"dkLen"),0===r||0!=(r&r-1))throw new Error("N must be power of 2");if(r>n/128/a)throw new Error("N too large");if(a>n/128/s)throw new Error("r too large");if(!h(t))throw new Error("password must be an array or buffer");if(t=Array.prototype.slice.call(t),!h(e))throw new Error("salt must be an array or buffer");e=Array.prototype.slice.call(e);let g=o(t,e,128*s*a);const d=new Uint32Array(32*s*a);for(let t=0;t<d.length;t++){const e=4*t;d[t]=(255&g[e+3])<<24|(255&g[e+2])<<16|(255&g[e+1])<<8|(255&g[e+0])<<0}const p=new Uint32Array(64*a),w=new Uint32Array(32*a*r),b=32*a,_=new Uint32Array(16),E=new Uint32Array(16),A=s*r*2;let m,v,U=0,L=null,B=!1,I=0,S=0;const K=y?parseInt(1e3/a):4294967295,k="undefined"!=typeof setImmediate?setImmediate:setTimeout,N=function(){if(B)return y(new Error("cancelled"),U/A);let e;switch(I){case 0:v=32*S*a,l(d,v,p,0,b),I=1,m=0;case 1:e=r-m,e>K&&(e=K);for(let t=0;t<e;t++)l(p,0,w,(m+t)*b,b),i(p,b,a,_,E);if(m+=e,U+=e,y){const t=parseInt(1e3*U/A);if(t!==L){if(B=y(null,U/A),B)break;L=t}}if(m<r)break;m=0,I=2;case 2:e=r-m,e>K&&(e=K);for(let t=0;t<e;t++){const t=p[16*(2*a-1)]&r-1;c(w,t*b,p,b),i(p,b,a,_,E)}if(m+=e,U+=e,y){const t=parseInt(1e3*U/A);if(t!==L){if(B=y(null,U/A),B)break;L=t}}if(m<r)break;if(l(p,0,d,v,b),S++,S<s){I=0;break}g=[];for(let t=0;t<d.length;t++)g.push(d[t]>>0&255),g.push(d[t]>>8&255),g.push(d[t]>>16&255),g.push(d[t]>>24&255);const n=o(t,g,f);return y&&y(null,1,n),n}y&&k(N)};if(!y)for(;;){const t=N();if(null!=t)return t}N()}const y={scrypt:function(t,e,n,r,o,i,a){return new Promise((function(s,c){let l=0;a&&a(0),f(t,e,n,r,o,i,(function(t,e,n){if(t)c(t);else if(n)a&&1!==l&&a(1),s(new Uint8Array(n));else if(a&&e!==l)return l=e,a(e)}))}))},syncScrypt:function(t,e,n,r,o,i){return new Uint8Array(f(t,e,n,r,o,i))}};t.exports=y}()},570:(t,e,n)=>{const r=n(481);e.check=async function(t,e){try{const n=await t.subarray(0,1e3),o=r.parse(n);return 0!==r.decrypt_header(o[0],e)[0].length}catch(t){console.trace("File checking wasn't possible!")}}},1:(t,e,n)=>{const r=n(541),o=n(85),i=n(635),a=r.string2byte("c4gh-v1"),s=r.string2byte("none"),c=r.string2byte("scrypt"),l=r.string2byte("none"),h=r.string2byte("chacha20_poly1305");async function u(t,e,n){console.log("secret und password: ",t,"  ",n);try{if(console.log("3"),console.log(t.subarray(0,7),"   ",t.subarray(9,15)),r.equal(t.subarray(0,7),a))if(console.log("8"),r.equal(t.subarray(9,13),s)){if(r.equal(t.subarray(15,19),l))return t.subarray(21)}else if(r.equal(t.subarray(9,15),c)){console.log("4");const e=t.subarray(17,37).subarray(4);if(r.equal(t.subarray(39,56),h)){const a=16384,s=8,c=1,l=32,h=i.scrypt(r.string2byte(n),e,a,s,c,l).then((function(e){const n=e,r=t.subarray(58,70),i=t.subarray(70);console.log("5"),console.log("shared: ",n);const a=o.createCipheriv("chacha20-poly1305",n,r);console.log("cipher: ",a);const s=a.update(i);console.log("encres: ",s);const c=new Uint8Array(s.subarray(0,32));return console.log("x: ",c),c}));return await h}}else console.trace("Wrong encryption method")}catch(t){console.trace("Secret key data could not be decrypted!")}}e.encryption_keyfiles=async(t,e="")=>{console.log("seckey in enc: ",t);const n=[];try{for(let o=0;o<t.length;o++){let i=new Uint8Array(32),a=new Uint8Array(32);const s=t[o].indexOf("\n");console.log("1");const c=t[o].indexOf("\n",s+1),l=t[o].indexOf("\n",c+1),h=t[o].substring(0,s);console.log("2");const f=t[o].substring(s+1,c),y=t[o].substring(c+1,l),g=r.base64ToArrayBuffer(f);if(console.log(h),"-----BEGIN CRYPT4GH PRIVATE KEY-----"===h&&"-----END CRYPT4GH PRIVATE KEY-----"===y)i=await u(g,0,e),n.push(i);else if("-----BEGIN CRYPT4GH PUBLIC KEY-----"===h&&"-----END CRYPT4GH PUBLIC KEY-----"===y){const e=t[o].substring(36,80);a=r.base64ToArrayBuffer(e),n.push(a)}else console.trace("Not a crypt4gh keyfile!")}return n}catch(t){console.trace("Keyfiles couldn't be decrypted!")}}},481:(t,e,n)=>{const r=n(541),o=n(664),i=n(322),a=n(481),s=n(85);e.SEGMENT_SIZE=65536;const c=r.string2byte("crypt4gh");e.pureDecryption=async function(t,e){const n=await t.subarray(0,12),r=await t.subarray(12),o=s.createDecipheriv("chacha20-poly1305",Buffer.from(e,"hex"),n).update(r),i=new Uint8Array(o.slice(0,-16));return await Promise.resolve(i)},e.pureEdit=function(t){return function(t){const e=function(t){let e=new BigInt64Array(t[3][0].buffer).subarray(1),n=[],r=0n;for(let t=0;t<e.length;t++)r+=e[t],n.push(r);let o=!1;const i=new BigInt64Array(e.length+1);if(e.length%2!=0){o=!0;const t=e.reduce(((t,e)=>t+e),0n);i.set(e),i[i.length-1]=65536n*(t/65536n+1n)-t}if(e.length%2!=0){n=[],e=i;let t=0n;for(let r=0;r<e.length;r++)t+=e[r],n.push(t)}return[n,e,o]}(t);let n=0;const r=new Map;for(let t=0;t<e[0].length;t++)if(t%2==0)n=Number((e[0][t]-1n)/65536n+1n);else{const o=Number((e[0][t]-1n)/65536n+1n);if(n===o&&t>=2)if(Number((e[0][t-2]-1n)/65536n+1n)===o)r.set(n,[...r.get(n),e[1][t-1]]),r.set(n,[...r.get(n),e[1][t]]);else{const i=[...r.keys()].pop(),a=65536n-r.get(i).reduce(((t,e)=>t+e),0n)+BigInt(65536*(o-2));r.set(n,[e[1][t-1]-a]),r.set(n,[...r.get(n),e[1][t]])}else if(n===o&&t<2)r.has(n)?e[1][t-1]>65536n?r.set(n,[...r.get(n),e[1][t-1]-65536n*BigInt(n-1)]):r.set(n,[...r.get(n),e[1][t-1]]):e[1][t-1]>65536n?r.set(n,[e[1][t-1]-65536n*BigInt(n-1)]):r.set(n,[e[1][t-1]]),r.set(n,[...r.get(n),e[1][t]]);else if(n!==o){r.has(n)?e[1][t-1]>65536n?r.set(n,[...r.get(n),e[1][t-1]-65536n*BigInt(n-1)]):r.set(n,[...r.get(n),e[1][t-1]]):e[1][t-1]>65536n?r.set(n,[e[1][t-1]-65536n*BigInt(n-1)]):r.set(n,[e[1][t-1]]),e[1][t-1]>65536?r.set(n,[...r.get(n),65536n*BigInt(n)-e[1][t-1]]):r.set(n,[...r.get(n),65536n-e[1][t-1]]);const i=[...r.keys()].pop(),a=e[1][t]/65536n;if(e[1][t]>65536n)for(let t=i+1;t<Number(a+1n);t++)r.set(t,[0n,65536n]);r.set(o,[0n]),Number(a)>0?e[1][t-1]>65536?r.set(o,[...r.get(o),e[1][t]-(65536n*BigInt(n)-e[1][t-1])]):r.set(o,[...r.get(o),e[1][t]-(65536n*a-e[1][t-1])]):e[1][t-1]>65536?r.set(o,[...r.get(o),e[1][t]-(65536n*BigInt(n)-e[1][t-1])]):r.set(o,[...r.get(o),e[1][t]-(65536n*(a+1n)-e[1][t-1])])}}return[r,e[2]]}(t)},e.header_deconstruction=function(t,e){try{const n=a.parse(t),r=a.decrypt_header(n[0],e),o=function(t){try{const e=[],n=[];for(let r=0;r<t.length;r++){const o=[t[r][0],t[r][1],t[r][2],t[r][3]].join("");"0000"===o?e.push(t[r].subarray(4)):"1000"===o?n.push(t[r].subarray(8)):console.trace("Invalid package type")}return[e,n]}catch(t){console.trace("Package partition not possible.")}}(r[0]);return[function(t){try{let e;return"0000"!==[t[0],t[1],t[2],t[3]].join("")?console.trace("Invalid encryption method!"):e=t.slice(4),e}catch(t){console.trace("encryption package could not be parsed.")}}(o[0][0]),r[2],n[1],o[1],n[2]]}catch(t){console.trace("header deconstruction not possible.")}},e.parse=function(t){try{(new TextDecoder).decode(t.subarray(0,8))!==(new TextDecoder).decode(c)&&console.trace("Not a crypt4gh file"),1!==new Uint8Array(t.subarray(8,12))[0]&&console.trace("Only version 1 is accepted");const e=new Uint32Array(new Uint8Array(t.subarray(12,16)));0===e[0]&&console.trace("No packages!");const n=a.extract_packets(e[0],t);return[n[0],n[1],n[2]]}catch(t){console.trace("header parsing not possible.")}},e.extract_packets=function(t,e){const n=[];let r=0;try{for(let o=0;o<t;o++){const t=[],i=16;if(0===o){const n=new Uint32Array(new Uint8Array(e.slice(16,20).buffer));r=i;for(let o=0;o<n[0];o++)t.push(e[r+o]);r+=n[0]}else{const n=new Uint32Array(new Uint8Array(e.slice(r,r+4)));for(let o=0;o<n[0];o++)t.push(e[r+o]);r+=n[0]}n.push(t)}return[n,e.slice(r),r]}catch(t){console.trace("packages couln't be extracted.")}},e.decrypt_header=function(t,e){try{e=[e];const n=[],r=[];let a;for(let c=0;c<t.length;c++){const l=new Uint8Array(t[c].slice(8,40));a=new Uint8Array(t[c].slice(40,52));const h=new Uint8Array(t[c].slice(52));for(let u=0;u<e.length;u++){const f=o.generateKeyPairFromSeed(e[u]),y=o.sharedKey(e[u],l),g=new Uint8Array(y.length+l.length+f.publicKey.length);g.set(y),g.set(f.publicKey,y.length),g.set(l,y.length+l.length);const d=new i.BLAKE2b;d.update(g);const p=d.digest().subarray(0,32),w="chacha20-poly1305",b=s.createDecipheriv(w,Buffer.from(p,"hex"),a).update(h),_=new Uint8Array(b.slice(0,-16));_?n.push(_):r.push(t[c])}}return[n,r,a]}catch(t){console.trace("Header could not be decrypted.")}},e.applyEditlist=function(t,e){try{const n=[];let r=BigInt(0);const o=BigInt(e.length);for(let i=0;i<t.length;i+=2)if(r+=t[i],i===t.length-1){const t=e.subarray(Number(r),Number(o));n.push(t)}else{const o=t[i+1],a=e.subarray(Number(r),Number(r)+Number(o));n.push(a),r+=o}let i=0;n.forEach((t=>{i+=t.length}));const a=new Uint8Array(i);let s=0;return n.forEach((t=>{a.set(t,s),s+=t.length})),a}catch(t){console.trace("edit list could not be applied.")}}},263:(t,e,n)=>{const r=n(541),o=n(664),i=n(322),a=n(263),s=n(85),c=new Uint32Array([0]),l=new Uint32Array([1]),h=r.string2byte("crypt4gh");e.encHeader=function(t,e){try{const n=new Uint32Array([0]),r=s.randomBytes(32),o=[],i=a.make_packet_data_enc(n,r);o.push(i);const c=a.header_encrypt(o,t,e);return[a.serialize(c[0],c[1],c[2],c[3]),r]}catch(t){console.trace("Header Encryption not possible.")}},e.encHeaderEdit=async function(t,e,n){try{const r=new Uint32Array([0]),o=s.randomBytes(32);return[await a.encryption_edit(n,r,o,e,t),o]}catch(t){console.trace("Header Encryption not possible.")}},e.pureEncryption=function(t,e){const n=s.randomBytes(12),r=s.createCipheriv("chacha20-poly1305",e,n),o=Buffer.concat([n,r.update(t),r.final(),r.getAuthTag()]);return new Uint8Array(o)},e.make_packet_data_enc=function(t,e){try{const n=new Uint8Array(t.buffer),r=new Uint8Array(c.buffer),o=new Uint8Array(n.length+r.length+e.length);return o.set(r),o.set(n,r.length),o.set(e,n.length+r.length),o}catch(t){console.trace("header encryption package could not be computed.")}},e.header_encrypt=function(t,e,n){try{const a=s.randomBytes(12),l=o.generateKeyPairFromSeed(e);let h;const u=[],f=new Uint8Array(c.buffer);let y,g=0;for(let c=0;c<n.length;c++){const d=[];for(let u=0;u<t.length;u++){!0===r.equal(t[u].subarray(0,4),f)&&0===g&&(y=[t[u][4],t[u][5],t[u][6],t[u][7]].join(""),g++);const p=o.sharedKey(e,n[c]),w=new Uint8Array(p.length+n[0].length+n[c].length);w.set(p),w.set(n[c],p.length),w.set(l.publicKey,p.length+n[c].length);const b=new i.BLAKE2b;b.update(w),h=b.digest().subarray(0,32);const _="chacha20-poly1305",E=s.createCipheriv(_,h,a),A=Buffer.concat([E.update(t[u]),E.final(),E.getAuthTag()]),m=new Uint8Array(A);d.push(m)}u.push(d)}return[y,l.publicKey,a,u,h]}catch(t){console.trace("header could not be encrypted.")}},e.serialize=function(t,e,n,r){try{Array.isArray(r[0])&&(r=[].concat(...r));const o=new Uint32Array([r.length]).buffer,i=new Uint8Array(o),a=new Uint32Array([1]).buffer,s=new Uint8Array(a),c=new Uint8Array(i.length+s.length+h.length);c.set(h),c.set(s,h.length),c.set(i,h.length+s.length);let l=0;const u=[];for(let o=0;o<r.length;o++){const i=new Uint32Array([r[o].length+t.length+e.length+n.length+4]).buffer,a=new Uint8Array(i),s=new Uint8Array(a.length+t.length+e.length+r[o].length+n.length);s.set(a),s.set(t,a.length),s.set(e,a.length+t.length),s.set(n,a.length+t.length+e.length),s.set(r[o],a.length+t.length+e.length+n.length),u.push(s),l+=s.length}let f=c.length;const y=new Uint8Array(c.length+l);y.set(c);for(let t=0;t<u.length;t++)y.set(u[t],f),f+=u[t].length;return y}catch(t){console.trace("Encrypted header could not be completed.")}},e.encryption_edit=async function(t,e,n,r,o){try{const i=[];if(!0!==Array.isArray(t[0])){const s=a.make_packet_edit_list(t),c=a.make_packet_data_enc(e,n);i.push(c,s);const l=a.header_encrypt(i,o,r);return[a.serialize(l[0],l[1],l[2],l[3]),1]}{const i=a.make_packet_edit_lists(t),s=a.make_packet_data_enc(e,n);if(i.length===r.length){const t=a.header_encrypt_multi_edit(i,s,o,r);return[a.serialize(t[0],t[1],t[2],t[3]),0]}}}catch(t){console.trace("Header including edit package could not be computed.")}},e.make_packet_edit_list=function(t){try{const e=[];for(let n=0;n<t.length;n++)e.push(BigInt(t[n]));const n=new BigUint64Array(e),r=new Uint8Array(n.buffer),o=new Uint32Array([t.length]),i=new Uint8Array(o.buffer),a=new Uint8Array(l.buffer),s=new Uint8Array(a.length+i.length+r.length);return s.set(a),s.set(i,a.length),s.set(r,i.length+a.length),s}catch(t){console.trace("edit list package could not be computed.")}},e.make_packet_edit_lists=function(t){try{const e=[];for(let n=0;n<t.length;n++){const r=[];for(let e=0;e<t[n].length;e++)r.push(BigInt(t[n][e]));const o=new BigUint64Array(r),i=new Uint8Array(o.buffer),a=new Uint32Array([t[n].length]),s=new Uint8Array(a.buffer),c=new Uint8Array(l.buffer),h=new Uint8Array(c.length+s.length+i.length);h.set(c),h.set(s,c.length),h.set(i,s.length+c.length),e.push(h)}return e}catch(t){console.trace("List of edit list packages could not be computed.")}},e.header_encrypt_multi_edit=function(t,e,n,a){try{let c=[];const l=s.randomBytes(12),h=o.generateKeyPairFromSeed(n);let u;const f=[],y=new Uint8Array([0,0,0,0]);let g;for(let d=0;d<a.length;d++){c=[e,t[d]];const p=[];for(let t=0;t<c.length;t++){!0===r.equal(c[t].subarray(0,4),y)&&(g=new Uint8Array([c[0][4],c[0][5],c[0][6],c[0][7]]));const e=o.sharedKey(n,a[d]),f=new Uint8Array(e.length+h.publicKey.length+a[d].length);f.set(e),f.set(a[d],e.length),f.set(h.publicKey,e.length+a[d].length);const w=new i.BLAKE2b;w.update(f),u=w.digest().subarray(0,32);const b="chacha20-poly1305",_=s.createCipheriv(b,u,l),E=Buffer.concat([l,_.update(c[t]),_.final(),_.getAuthTag()]);p.push(E)}f.push(p)}return[g,h.publicKey,l,f]}catch(t){console.trace("Header for encryption with mulitple edit lists could not be computed.")}}},541:(t,e)=>{e.string2byte=function(t){try{const e=new Uint8Array(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}catch(t){console.trace("conversion not possible")}},e.equal=function(t,e){try{if(t.byteLength!==e.byteLength)return!1;const n=new Int8Array(t),r=new Int8Array(e);for(let e=0;e!==t.byteLength;e++)if(n[e]!==r[e])return!1;return!0}catch(t){console.trace("comparing not possible.")}},e.base64ToArrayBuffer=function(t){try{const e=atob(t),n=new Uint8Array(e.length);for(let t=0;t<e.length;t++)n[t]=e.charCodeAt(t);return n}catch(t){console.trace("conversion not possible.")}}},610:(t,e,n)=>{const r=n(541),o=n(664),i=n(635),a=n(610),s=n(85),c=r.string2byte("c4gh-v1"),l=r.string2byte("none"),h=r.string2byte("none"),u=r.string2byte("scrypt"),f=r.string2byte("chacha20_poly1305");e.keygen=async function(t){try{const e=o.generateKeyPair(),n=a.create_pubkey(e.publicKey);return[await a.create_seckey(e.secretKey,t),n]}catch(t){console.trace("Key generation not possible.")}},e.create_pubkey=function(t){try{return"-----BEGIN CRYPT4GH PUBLIC KEY-----\n"+btoa(String.fromCharCode.apply(null,t))+"\n-----END CRYPT4GH PUBLIC KEY-----\n"}catch(t){console.trace("Pubkey generation not possible.")}},e.create_seckey=async function(t,e){try{if(""!==e){const n=s.randomBytes(16),o=new Uint8Array(4+n.length);o.set([0,0,0,0]),o.set(n,4);const a=16384,l=8,h=1,y=32,g=i.scrypt(r.string2byte(e),n,a,l,h,y).then((function(e){const n=s.randomBytes(12),r=s.createCipheriv("chacha20-poly1305",e,n),i=Buffer.concat([r.update(t),r.final(),r.getAuthTag()]),a=new Uint8Array(i),l=new Uint8Array(c.length+u.length+f.length+a.length+8+n.length+o.length);return l.set(c),l.set([0,6],c.length),l.set(u,c.length+2),l.set([0,20],c.length+u.length+2),l.set(o,c.length+u.length+4),l.set([0,17],c.length+u.length+o.length+4),l.set(f,c.length+u.length+o.length+6),l.set([0,12+a.length],c.length+u.length+f.length+o.length+6),l.set(n,c.length+u.length+f.length+o.length+8),l.set(a,c.length+u.length+f.length+n.length+o.length+8),"-----BEGIN CRYPT4GH PRIVATE KEY-----\n"+btoa(String.fromCharCode.apply(null,l))+"\n-----END CRYPT4GH PRIVATE KEY-----\n"}));return await g}{const e=new Uint8Array(c.length+l.length+h.length+t.length+6);return e.set(c),e.set([0,4],c.length),e.set(l,c.length+2),e.set([0,4],c.length+l.length+2),e.set(h,c.length+l.length+4),e.set([0,32],c.length+l.length+h.length+4),e.set(t,c.length+l.length+h.length+6),"-----BEGIN CRYPT4GH PRIVATE KEY-----\n"+btoa(String.fromCharCode.apply(null,e))+"\n-----END CRYPT4GH PRIVATE KEY-----\n"}}catch(t){console.trace("Secret key generation not possible.")}}},826:(t,e,n)=>{const r=n(263),o=n(481),i=n(826);async function a(t,e,n,o,a,h){try{const u=new Uint32Array([0]),f=function(t){try{const e=[],n=[];for(let r=0;r<t.length;r++){const o=[t[r][0],t[r][1],t[r][2],t[r][3]].join("");if("0000"===o)e.push(t[r].subarray(4));else{if("1000"!==o)throw Error("Invalid packet type");n.push(t[r].subarray(8))}}return[e,n]}catch(t){console.trace("Packages could not be partitionated.")}}(t);if(0===f[1].length)return await r.encryption_edit(e,u,h,o,a);{const y=f[1][0],g=new BigUint64Array(y.buffer);let d;const p=[];if(!0===Array.isArray(e[0])){const t=await async function(t,e,n,o,a,h,u,f,y){for(let r=0;r<t.length;r++){if((e.length-1)%2!=0){const t=s(n,e,o);o=t[0],e=t[1]}else o=e.slice(1);t[r].length%2!=0&&(t[r]=c(n,t[r]));const h=i.parts(o),u=i.parts(t[r]),f=l(h,u);if(f.length===u.length)for(let t=0;t<f.length;t++)0===t&&a.push(0),f[t][0]===u[t][0]&&f[t][1]===u[t][1]||a.push(1)}if(!a.includes(1))return await r.encryption_edit(t,h,u,f,y)}(e,g,n,d,p,u,h,o,a);return t}{const h=await async function(t,e,n,o,a,h,u){if((t.length-1)%2!=0){const r=s(e,t,n);n=r[0],t=r[1]}else n=t.slice(1);o.length%2!=0&&(o=c(e,o));const f=i.parts(n),y=i.parts(o),g=l(f,y);let d;if(g.length===y.length){for(let t=0;t<g.length;t++)0===t&&(d=0),g[t][0]===y[t][0]&&g[t][1]===y[t][1]||(d=1);if(0===d){const t=r.make_packet_edit_list(o),e=r.header_encrypt([a[0],t],h,u);return[r.serialize(e[0],e[1],e[2],e[3]),1]}}}(g,n,d,e,t,a,o);return h}}}catch(t){console.trace("header could not be rearranged.")}}function s(t,e,n){try{let r=0,o=0;for(;r<=t-65564;)r+=65564,o++;r<t&&o++;let i=BigInt(0);(n=new BigUint64Array(e.length)).set(e.slice(1)),n.forEach((t=>{i+=t}));const a=BigInt(t)-BigInt(28*o)-i;return n.set([a],e.length-1),[n,e]}catch(t){console.trace("old edit list could not be analysed.")}}function c(t,e){try{let n=0,r=0,o=0;for(;r<=t-65564;)r+=65564,o++;return r<t&&o++,e.forEach((t=>{n+=t})),e.push(t-28*o-n),e}catch(t){console.trace("new edit list could not be analysed.")}}function l(t,e){try{const n=[];for(let r=0;r<t.length;r++){let o=0;for(let i=0;i<e.length;i++)t[r][0]<=BigInt(e[i][0])&&t[r][1]>=BigInt(e[i][1])&&(n.push(e[i]),o++);o<0&&console.trace("unencryptable data")}return n}catch(t){console.trace("data acess could not be checked.")}}e.rearrange=async function(t,e,n,r){try{const i=[],s=await t.subarray(0,1e4),c=o.parse(s),l=async function(t,e,n,r,o,i,s){try{const c=t[0][0].subarray(8),l=await a(t[0],e,n[1].length,r,o,c);if(l){i.push(l[0]);const t=65536;let e=n[2];for(;e<s.length;){const n=await s.subarray(e,e+t);i.push(n),e+=t}return i}}catch(t){console.trace("Rearrangment could not be computed.")}}(o.decrypt_header(c[0],e),r,c,n,e,i,t);return l}catch(t){console.trace("Data could not be rearranged.")}},e.streamRearrange=async function(t,e,n,r){const i=o.parse(t),s=o.decrypt_header(i[0],e),c=s[0][0].subarray(8);return[(await a(s[0],r,i[1].length,n,e,c))[0],i[2]]},e.parts=function(t){try{let e=BigInt(0);const n=[];for(let r=0;r<t.length;r+=2){const o=t[r];if(e+=BigInt(o),r+1<t.length){const o=BigInt(t[r+1]);n.push([e,e+o]),e+=BigInt(o)}else{const o=BigInt(t[r+1]);n.push([e,e+o])}}return n}catch(t){console.trace("decryptable parts could not be computed.")}}},734:(t,e,n)=>{const r=n(664),o=n(263),i=n(481),a=r.generateKeyPair();e.reencrypt=async function*(t,e,n){try{const r=await t.subarray(0,1e4),s=i.parse(r),c=i.decrypt_header(s[0],n),l=[c[0][0]];l.push(c[0][0]),e.unshift(a.publicKey);const h=o.header_encrypt(l,a.secretKey,e),u=o.serialize(h[0],e[0],h[2],h[3]),f=65536;let y=s[2];for(;y<t.length;)if(0===y){const e=await t.subarray(y,y+f),n=new Uint8Array(u.length+e.length);n.set(u),n.set(e,u.length),yield await Promise.resolve(n),y+=f}else{const e=await t.subarray(y,y+f);yield await Promise.resolve(e),y+=f}}catch(t){console.trace("Reeencryption not possible.")}},e.streamReencryptHeader=function(t,e,n){const r=i.parse(t),s=i.decrypt_header(r[0],n),c=[s[0][0]];c.push(s[0][0]),e.unshift(a.publicKey);const l=o.header_encrypt(c,a.secretKey,e);return[o.serialize(l[0],e[0],l[2],l[3]),r[2]]}},883:()=>{},85:()=>{}},e={};function n(r){var o=e[r];if(void 0!==o)return o.exports;var i=e[r]={exports:{}};return t[r].call(i.exports,i,i.exports,n),i.exports}(()=>{const t=n(610),e=n(1);n(263),n(481),n(734),n(826),n(570),document.getElementById("input").addEventListener("change",(function(t){console.log("hier");const n=document.getElementById("input").files[0],r=(document.getElementById("input").files[1],document.getElementById("psw").value);document.getElementById("block").value,console.log(n),(async()=>{const t=await n.text();console.log("seckey: ",t);const o=await e.encryption_keyfiles([t],r);console.log(o),document.getElementById("filecontents").innerText=o})()})),document.getElementById("submit").addEventListener("click",(async function(e){const n=await document.getElementById("psw2").value;console.log("password: ",n);const r=t.keygen(n),o=await r;document.getElementById("pubkeyfile").innerText=o[1],document.getElementById("seckeyfile").innerText=o[0]}))})()})();